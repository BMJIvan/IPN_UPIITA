	PROCESSOR	P16F887
	INCLUDE		<P16F887.INC>

	__CONFIG _CONFIG1, (_INTRC_OSC_NOCLKOUT & _WDT_OFF & _PWRTE_OFF & _MCLRE_OFF & _CP_OFF & _CPD_OFF & _BOR_OFF & _IESO_OFF & _FCMEN_OFF & _LVP_OFF & _DEBUG_OFF)
	__CONFIG _CONFIG2, (_WRT_OFF & _BOR40V)
	
CX		EQU			0x21
VC0		EQU			0x22
VC1		EQU			0x23
VC2		EQU			0x24
VC3		EQU			0x25
VC4		EQU			0x26
VC5		EQU			0x27
VC6		EQU			0x28
VC7		EQU			0x29	
VX		EQU			0x30
CL		EQU			0x31
CCL		EQU			0x32

		ORG			0x00
		BANKSEL		ANSEL
		MOVLW		0xFF
		MOVWF		ANSEL
		CLRF		ANSELH
		
		BANKSEL		TRISA
		CLRF		TRISA
		CLRF		TRISB
		CLRF		TRISC
		CLRF		TRISD
		MOVLW		0x07
		MOVWF		TRISE
		MOVLW		0xD6
		MOVWF		OPTION_REG
		CLRF		ADCON1
		
		BANKSEL		PORTA
		CLRF		VC0	
		CLRF		VC1
		CLRF		VC2
		CLRF		VC3
		CLRF		VC4
		CLRF		VC5
		CLRF		VC6
		CLRF		VC7

C_P
		MOVLW		0x1E
		MOVWF		CL
		CLRF		CCL

C_MOV	

		MOVLW		0x20
		MOVWF		CX	
C_MOS
			
		MOVF		VC0,W
		MOVWF		PORTB
		MOVLW		0x7F
		MOVWF		PORTC
		CALL 		RT	
		CALL 		RTT
		
		MOVF		VC1,W
		MOVWF		PORTB
		MOVLW		0xBF
		MOVWF		PORTC
		CALL 		RT
		CALL 		RTT

		MOVF		VC2,W
		MOVWF		PORTB
		MOVLW		0xDF
		MOVWF		PORTC
		CALL 		RT
		CALL 		RTT

		MOVF		VC3,W
		MOVWF		PORTB
		MOVLW		0xEF
		MOVWF		PORTC
		CALL 		RT
		CALL 		RTT		
		
		MOVF		VC4,W
		MOVWF		PORTB
		MOVLW		0xF7
		MOVWF		PORTC
		CALL 		RT
		CALL 		RTT
		
		MOVF		VC5,W
		MOVWF		PORTB
		MOVLW		0xFB
		MOVWF		PORTC
		CALL 		RT
		CALL 		RTT

		MOVF		VC6,W
		MOVWF		PORTB
		MOVLW		0xFD
		MOVWF		PORTC
		CALL 		RT
		CALL 		RTT

		MOVF		VC7,W
		MOVWF		PORTB
		MOVLW		0xFE
		MOVWF		PORTC
		CALL 		RT
		CALL 		RTT

		DECFSZ		CX,F
		GOTO		C_MOS
		
		CALL 		MOV
		MOVF		CCL,W
		CALL 		MLET
		MOVWF		VC7
		INCF		CCL	
		DECFSZ		CL,F
		GOTO 		C_MOV

		GOTO		C_P


	
MOV
		MOVF		VC1,W
		MOVWF		VC0
		MOVF		VC2,W
		MOVWF		VC1
		MOVF		VC3,W
		MOVWF		VC2
		MOVF		VC4,W
		MOVWF		VC3
		MOVF		VC5,W
		MOVWF		VC4
		MOVF		VC6,W
		MOVWF		VC5
		MOVF		VC7,W
		MOVWF		VC6
	RETURN

MLET	
		ADDWF		PCL,F
		RETLW		0xFE
		RETLW		0x92
		RETLW		0x92
		RETLW		0x92
		RETLW		0x6C

		RETLW		0x00		

		RETLW		0xFE
		RETLW		0x40
		RETLW		0x20
		RETLW		0x10
		RETLW		0x20
		RETLW		0x40
		RETLW		0xFE

		RETLW		0x00

		RETLW		0x82
		RETLW		0x82
		RETLW		0x82
		RETLW		0xFE
		RETLW		0x80
		RETLW		0x80
		RETLW		0x80

		RETLW		0x00

		RETLW		0x82
		RETLW		0x82
		RETLW		0x82
		RETLW		0xFE
		RETLW		0x82
		RETLW		0x82
		RETLW		0x82

		RETLW		0x00

RT
		CLRF	TMR0
E64I	BTFSS	TMR0,4
		GOTO	E64I
		RETURN

		
RTT
		CLRF	TMR0
E64		BTFSS	TMR0,3
		GOTO	E64
		RETURN

		END